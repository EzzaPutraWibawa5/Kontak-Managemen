<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Testing - Contact Management</title>
    <link rel="stylesheet" href="index.html">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
        }

        .test-controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-info {
            background: #3b82f6;
            color: white;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .test-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .test-card h3 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .test-item {
            padding: 10px;
            margin: 8px 0;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-pass {
            background: #d1fae5;
            color: #065f46;
        }

        .test-fail {
            background: #fee2e2;
            color: #991b1b;
        }

        .test-pending {
            background: #e0e7ff;
            color: #3730a3;
        }

        .test-icon {
            font-size: 18px;
            font-weight: bold;
        }

        .summary {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .summary h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-card.total {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .stat-card.passed {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .stat-card.failed {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .stat-card h3 {
            font-size: 36px;
            margin-bottom: 5px;
        }

        .stat-card p {
            font-size: 14px;
            opacity: 0.9;
        }

        .log-section {
            background: #1e293b;
            color: #94a3b8;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
        }

        .log-info { color: #3b82f6; }
        .log-success { color: #10b981; }
        .log-error { color: #ef4444; }
        .log-warning { color: #f59e0b; }

        @media (max-width: 768px) {
            .test-results {
                grid-template-columns: 1fr;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ§ª System Testing - Contact Management System</h1>
            <p>Comprehensive End-to-End Testing Suite</p>
        </div>

        <div class="test-controls">
            <div class="btn-group">
                <button class="btn-primary" onclick="runAllTests()">â–¶ Run All Tests</button>
                <button class="btn-success" onclick="runFunctionalTests()">âœ“ Functional Tests</button>
                <button class="btn-info" onclick="runUITests()">ðŸŽ¨ UI/UX Tests</button>
                <button class="btn-warning" onclick="runPerformanceTests()">âš¡ Performance Tests</button>
                <button class="btn-danger" onclick="clearResults()">ðŸ—‘ Clear Results</button>
            </div>
        </div>

        <div class="test-results" id="testResults"></div>

        <div class="summary" id="summary" style="display: none;">
            <h2>ðŸ“Š Test Summary</h2>
            <div class="stats">
                <div class="stat-card total">
                    <h3 id="totalTests">0</h3>
                    <p>Total Tests</p>
                </div>
                <div class="stat-card passed">
                    <h3 id="passedTests">0</h3>
                    <p>Passed</p>
                </div>
                <div class="stat-card failed">
                    <h3 id="failedTests">0</h3>
                    <p>Failed</p>
                </div>
            </div>
        </div>

        <div class="log-section" id="logSection">
            <div class="log-entry log-info">System Testing Console - Ready</div>
        </div>
    </div>

    <!-- Import script dari aplikasi utama -->
    <script src="script.js"></script>
    
    <script>
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            tests: []
        };

        function log(message, type = 'info') {
            const logSection = document.getElementById('logSection');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logSection.appendChild(entry);
            logSection.scrollTop = logSection.scrollHeight;
        }

        function addTestResult(category, testName, passed, details = '') {
            testResults.total++;
            if (passed) {
                testResults.passed++;
            } else {
                testResults.failed++;
            }

            testResults.tests.push({
                category,
                name: testName,
                passed,
                details
            });

            log(`${passed ? 'âœ“' : 'âœ—'} ${testName}`, passed ? 'success' : 'error');
        }

        function updateSummary() {
            document.getElementById('summary').style.display = 'block';
            document.getElementById('totalTests').textContent = testResults.total;
            document.getElementById('passedTests').textContent = testResults.passed;
            document.getElementById('failedTests').textContent = testResults.failed;
        }

        function displayResults() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = '';

            const categories = [...new Set(testResults.tests.map(t => t.category))];

            categories.forEach(category => {
                const card = document.createElement('div');
                card.className = 'test-card';
                
                const categoryTests = testResults.tests.filter(t => t.category === category);
                
                card.innerHTML = `
                    <h3>${category}</h3>
                    ${categoryTests.map(test => `
                        <div class="test-item ${test.passed ? 'test-pass' : 'test-fail'}">
                            <span class="test-icon">${test.passed ? 'âœ“' : 'âœ—'}</span>
                            <div>
                                <strong>${test.name}</strong>
                                ${test.details ? `<div style="font-size: 12px; margin-top: 4px;">${test.details}</div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                `;
                
                resultsDiv.appendChild(card);
            });

            updateSummary();
        }

        // ========================================
        // FUNCTIONAL TESTS
        // ========================================
        async function runFunctionalTests() {
            log('Starting Functional Tests...', 'info');

            // Test 1: Data Loading
            try {
                const dataLoaded = typeof contacts !== 'undefined' && contacts.length > 0;
                addTestResult('Functional Tests', 'Data Loading', dataLoaded, 
                    `Loaded ${contacts ? contacts.length : 0} contacts`);
            } catch (e) {
                addTestResult('Functional Tests', 'Data Loading', false, e.message);
            }

            // Test 2: Add Functionality
            try {
                const initialCount = contacts.length;
                const newContact = {
                    id: Date.now(),
                    name: 'Test Contact',
                    email: 'test@system.com',
                    phone: '081111111111',
                    address: 'Test Address',
                    company: 'Test Company'
                };
                contacts.push(newContact);
                const added = contacts.length === initialCount + 1;
                addTestResult('Functional Tests', 'Add Contact', added,
                    `Contact ${added ? 'successfully' : 'failed to be'} added`);
                
                // Cleanup
                contacts = contacts.filter(c => c.id !== newContact.id);
            } catch (e) {
                addTestResult('Functional Tests', 'Add Contact', false, e.message);
            }

            // Test 3: Search Functionality
            try {
                const searchTerm = contacts[0]?.name.substring(0, 4).toLowerCase();
                const results = contacts.filter(c => 
                    c.name.toLowerCase().includes(searchTerm)
                );
                const searchWorks = results.length > 0;
                addTestResult('Functional Tests', 'Search Contact', searchWorks,
                    `Found ${results.length} results for "${searchTerm}"`);
            } catch (e) {
                addTestResult('Functional Tests', 'Search Contact', false, e.message);
            }

            // Test 4: Edit Functionality
            try {
                const testContact = contacts[0];
                const originalName = testContact.name;
                testContact.name = 'Edited Name';
                const edited = testContact.name === 'Edited Name';
                testContact.name = originalName; // Restore
                addTestResult('Functional Tests', 'Edit Contact', edited,
                    'Contact data can be modified');
            } catch (e) {
                addTestResult('Functional Tests', 'Edit Contact', false, e.message);
            }

            // Test 5: Delete Functionality
            try {
                const tempContact = {
                    id: 999999,
                    name: 'Temp',
                    email: 'temp@test.com',
                    phone: '089999999999'
                };
                contacts.push(tempContact);
                const beforeDelete = contacts.length;
                contacts = contacts.filter(c => c.id !== tempContact.id);
                const deleted = contacts.length === beforeDelete - 1;
                addTestResult('Functional Tests', 'Delete Contact', deleted,
                    'Contact successfully removed');
            } catch (e) {
                addTestResult('Functional Tests', 'Delete Contact', false, e.message);
            }

            // Test 6: Validation
            try {
                const validContact = {
                    name: 'Valid Name',
                    email: 'valid@email.com',
                    phone: '081234567890'
                };
                const isValid = validContact.name && validContact.email && validContact.phone;
                addTestResult('Functional Tests', 'Input Validation', isValid,
                    'Required fields validation works');
            } catch (e) {
                addTestResult('Functional Tests', 'Input Validation', false, e.message);
            }

            displayResults();
            log('Functional Tests Completed', 'success');
        }

        // ========================================
        // UI/UX TESTS
        // ========================================
        async function runUITests() {
            log('Starting UI/UX Tests...', 'info');

            // Test 1: DOM Elements Existence
            const searchInput = document.getElementById('searchInput');
            addTestResult('UI/UX Tests', 'Search Input Element', searchInput !== null,
                'Search input field exists');

            const contactsGrid = document.getElementById('contactsGrid');
            addTestResult('UI/UX Tests', 'Contacts Grid Element', contactsGrid !== null,
                'Contacts grid container exists');

            const modal = document.getElementById('modal');
            addTestResult('UI/UX Tests', 'Modal Element', modal !== null,
                'Modal dialog exists');

            // Test 2: Button Elements
            const buttons = document.querySelectorAll('button');
            addTestResult('UI/UX Tests', 'Interactive Buttons', buttons.length > 0,
                `Found ${buttons.length} interactive buttons`);

            // Test 3: CSS Styling
            try {
                const cardStyle = window.getComputedStyle(document.querySelector('.card'));
                const hasBackground = cardStyle.background !== '';
                addTestResult('UI/UX Tests', 'CSS Styling Applied', hasBackground,
                    'Styles are properly loaded');
            } catch (e) {
                addTestResult('UI/UX Tests', 'CSS Styling Applied', false, e.message);
            }

            // Test 4: Responsive Design
            const viewportWidth = window.innerWidth;
            const isMobile = viewportWidth < 768;
            addTestResult('UI/UX Tests', 'Responsive Design Detection', true,
                `Device: ${isMobile ? 'Mobile' : 'Desktop'} (${viewportWidth}px)`);

            // Test 5: Form Elements
            const formInputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"]');
            addTestResult('UI/UX Tests', 'Form Input Fields', formInputs.length >= 5,
                `Found ${formInputs.length} form input fields`);

            displayResults();
            log('UI/UX Tests Completed', 'success');
        }

        // ========================================
        // PERFORMANCE TESTS
        // ========================================
        async function runPerformanceTests() {
            log('Starting Performance Tests...', 'info');

            // Test 1: Render Performance
            try {
                const startTime = performance.now();
                renderContacts();
                const endTime = performance.now();
                const renderTime = endTime - startTime;
                addTestResult('Performance Tests', 'Render Speed', renderTime < 100,
                    `Rendered in ${renderTime.toFixed(2)}ms`);
            } catch (e) {
                addTestResult('Performance Tests', 'Render Speed', false, e.message);
            }

            // Test 2: Search Performance
            try {
                const startTime = performance.now();
                const results = contacts.filter(c => 
                    c.name.toLowerCase().includes('test')
                );
                const endTime = performance.now();
                const searchTime = endTime - startTime;
                addTestResult('Performance Tests', 'Search Speed', searchTime < 10,
                    `Search completed in ${searchTime.toFixed(2)}ms`);
            } catch (e) {
                addTestResult('Performance Tests', 'Search Speed', false, e.message);
            }

            // Test 3: Data Processing
            try {
                const startTime = performance.now();
                const processed = contacts.map(c => ({...c}));
                const endTime = performance.now();
                const processTime = endTime - startTime;
                addTestResult('Performance Tests', 'Data Processing', processTime < 10,
                    `Processed ${contacts.length} contacts in ${processTime.toFixed(2)}ms`);
            } catch (e) {
                addTestResult('Performance Tests', 'Data Processing', false, e.message);
            }

            // Test 4: Memory Usage
            try {
                if (performance.memory) {
                    const usedMemory = (performance.memory.usedJSHeapSize / 1048576).toFixed(2);
                    addTestResult('Performance Tests', 'Memory Usage', true,
                        `Using ${usedMemory} MB`);
                } else {
                    addTestResult('Performance Tests', 'Memory Usage', true,
                        'Memory API not available');
                }
            } catch (e) {
                addTestResult('Performance Tests', 'Memory Usage', false, e.message);
            }

            displayResults();
            log('Performance Tests Completed', 'success');
        }

        // ========================================
        // RUN ALL TESTS
        // ========================================
        async function runAllTests() {
            clearResults();
            log('='.repeat(50), 'info');
            log('Starting Complete System Test Suite...', 'info');
            log('='.repeat(50), 'info');

            await runFunctionalTests();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await runUITests();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await runPerformanceTests();

            log('='.repeat(50), 'info');
            log(`All Tests Completed! Passed: ${testResults.passed}/${testResults.total}`, 
                testResults.failed === 0 ? 'success' : 'warning');
            log('='.repeat(50), 'info');
        }

        function clearResults() {
            testResults = {
                total: 0,
                passed: 0,
                failed: 0,
                tests: []
            };
            document.getElementById('testResults').innerHTML = '';
            document.getElementById('summary').style.display = 'none';
            document.getElementById('logSection').innerHTML = 
                '<div class="log-entry log-info">System Testing Console - Ready</div>';
            log('Results cleared', 'info');
        }

        // Auto-run on load
        window.addEventListener('load', () => {
            log('System Testing Suite Loaded', 'success');
            log('Click "Run All Tests" to begin testing', 'info');
        });
    </script>
</body>
</html>